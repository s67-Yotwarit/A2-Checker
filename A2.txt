import tkinter as tk
from tkinter import messagebox, filedialog

class Checkers:
    def __init__(self, master):
        self.master = master
        self.master.title("‡πÄ‡∏Å‡∏°‡∏´‡∏°‡∏≤‡∏Å‡∏Æ‡∏≠‡∏™")
        self.board = [[0] * 8 for _ in range(8)]  # 0 = ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á, 1 = ‡∏´‡∏°‡∏≤‡∏Å‡πÅ‡∏î‡∏á, 2 = ‡∏´‡∏°‡∏≤‡∏Å‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
        self.current_player = "‡πÅ‡∏î‡∏á"
        self.selected_piece = None
        self.red_score = 0
        self.blue_score = 0

        self.create_board()

        # ‡πÄ‡∏û‡∏¥‡πà‡∏° Label ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
        self.turn_label = tk.Label(self.master, text=f"‡∏ï‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô: {self.current_player}", font=('Arial', 16))
        self.turn_label.grid(row=8, column=0, columnspan=8)

        # ‡πÄ‡∏û‡∏¥‡πà‡∏° Label ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
        self.score_label = tk.Label(self.master, text=f"‡πÅ‡∏î‡∏á: {self.red_score}   ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô: {self.blue_score}", font=('Arial', 14))
        self.score_label.grid(row=9, column=0, columnspan=8)

    def create_board(self):
        self.buttons = [[None] * 8 for _ in range(8)]
        for row in range(8):
            for col in range(8):
                if (row + col) % 2 == 1:
                    color = "darkgray"  # ‡∏™‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ
                    button = tk.Button(self.master, width=6, height=3, bg=color,
                                       command=lambda r=row, c=col: self.on_click(r, c))
                else:
                    color = "lightgray"  # ‡∏™‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ
                    button = tk.Button(self.master, width=6, height=3, bg=color, state=tk.DISABLED)

                button.grid(row=row, column=col)
                self.buttons[row][col] = button
            
        self.initialize_pieces() 
    
    def initialize_pieces(self):
        for row in range(2):
            for col in range(8):
                if (row + col) % 2 == 1:
                    self.board[row][col] = 1  # ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç 1 ‡πÅ‡∏ó‡∏ô‡∏´‡∏°‡∏≤‡∏Å‡πÅ‡∏î‡∏á
                    self.buttons[row][col].config(text="üî¥", fg="red")

        for row in range(6, 8):
            for col in range(8):
                if (row + col) % 2 == 1:
                    self.board[row][col] = 2  # ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç 2 ‡πÅ‡∏ó‡∏ô‡∏´‡∏°‡∏≤‡∏Å‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô
                    self.buttons[row][col].config(text="üîµ", fg="blue")
     
    def unselect_piece(self):
        # ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏Å
        self.selected_piece = None
        # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥
        for row in range(8):
            for col in range(8):
                if (row + col) % 2 == 1:
                    color = "darkgray"  # ‡∏ñ‡πâ‡∏≤‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏°‡∏∑‡∏î
                    self.buttons[row][col].config(bg=color)

    def on_click(self, row, col):
        if self.selected_piece:
            # ‡∏´‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß
            if (row, col) == self.selected_piece:
                # ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                self.unselect_piece()
            elif self.is_valid_move(row, col):
                # ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                self.move_piece(row, col)
                self.current_player = "‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô" if self.current_player == "‡πÅ‡∏î‡∏á" else "‡πÅ‡∏î‡∏á"
                self.turn_label.config(text=f"‡∏ï‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô: {self.current_player}")
                self.selected_piece = None
        else:
            # ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            if self.board[row][col] == 1 and self.current_player == "‡πÅ‡∏î‡∏á":
                self.selected_piece = (row, col)
            elif self.board[row][col] == 2 and self.current_player == "‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô":
                self.selected_piece = (row, col)
    
    def is_valid_move(self, row, col):
        if self.selected_piece is None:
            return False

        start_row, start_col = self.selected_piece
        piece = self.board[start_row][start_col]

        if self.board[row][col] != 0:
            return False  # ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å‡∏°‡∏µ‡∏´‡∏°‡∏≤‡∏Å‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß

        direction = 1 if piece == 1 else -1  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà

        # ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏ä‡πà‡∏≠‡∏á‡πÑ‡∏õ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤
        if (row - start_row) == direction and abs(col - start_col) == 1:
            return True

        # ‡∏Å‡∏¥‡∏ô‡∏´‡∏°‡∏≤‡∏Å
        if (row - start_row) == 2 * direction and abs(col - start_col) == 2:
            mid_row = (start_row + row) // 2
            mid_col = (start_col + col) // 2
            if self.board[mid_row][mid_col] != 0 and self.board[mid_row][mid_col] != piece:
                return True

        return False

    def move_piece(self, row, col):
        start_row, start_col = self.selected_piece
        piece = self.board[start_row][start_col]

        # ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ö‡∏≠‡∏£‡πå‡∏î
        self.board[start_row][start_col] = 0  # ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
        self.board[row][col] = piece

        # ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI
        self.buttons[start_row][start_col].config(text="", bg="lightgray" if (start_row + start_col) % 2 == 0 else "darkgray")
        self.buttons[row][col].config(text="üî¥" if piece == 1 else "üîµ", fg="red" if piece == 1 else "blue")

        # ‡∏ñ‡πâ‡∏≤‡∏Å‡∏¥‡∏ô‡∏´‡∏°‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏¥‡∏ô
        if abs(row - start_row) == 2:
            mid_row = (start_row + row) // 2
            mid_col = (start_col + col) // 2
            self.board[mid_row][mid_col] = 0  # ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏¥‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
            self.buttons[mid_row][mid_col].config(text="", bg="lightgray" if (mid_row + mid_col) % 2 == 0 else "darkgray")

    # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏´‡∏°‡∏≤‡∏Å
            if self.current_player == "‡πÅ‡∏î‡∏á":
                self.red_score += 1
            else:
                self.blue_score += 1

        self.update_score_display()

    def update_score_display(self):
        # ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏ô Label
        self.score_label.config(text=f"‡πÅ‡∏î‡∏á: {self.red_score}   ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô: {self.blue_score}")

if __name__ == "__main__":
    root = tk.Tk()
    game = Checkers(root)
    root.mainloop()
